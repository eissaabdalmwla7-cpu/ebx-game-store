<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>EBX GAME STORE ‚Äî ÿßŸÑŸÖÿ™ÿ¨ÿ± ÿßŸÑŸÖÿ™ŸÉÿßŸÖŸÑ</title>
  <meta name="description" content="ŸÖÿ™ÿ¨ÿ± ÿ¥ÿ≠ŸÜ ÿ£ŸÑÿπÿßÿ® ÿ≥ÿ±Ÿäÿπ Ÿàÿ¢ŸÖŸÜ: PUBG, Free Fire, CODM, Arena Breakout, Ludo, MLBB, Fortnite. ÿ£ÿ≥ÿπÿßÿ± ŸÖÿ≠ÿØÿ´ÿ© ŸàÿÆÿØŸÖÿ© Ÿàÿßÿ™ÿ≥ÿßÿ® ŸÅŸàÿ±Ÿäÿ©." />
  <meta name="theme-color" content="#00cfff" />

  <!-- ÿÆÿ∑Ÿàÿ∑ -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;800&display=swap" rel="stylesheet">

  <!-- CSS ŸÉÿßŸÖŸÑ -->
  <style>
    :root{
      --bg:#07121c;
      --card:#0b1b29;
      --neon:#00cfff;
      --text:#e8f6ff;
      --muted:#9bc7d6;
      --danger:#ff4d6d;
      --success:#1ee5a1;
      --shadow: 0 12px 40px rgba(0,207,255,.06);
      --glow: 0 0 14px rgba(0,207,255,.30), 0 0 28px rgba(0,207,255,.12);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:'Cairo', system-ui, -apple-system, "Segoe UI", Roboto, sans-serif;
      color:var(--text);
      background-color:var(--bg);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      line-height:1.4;

      /* ÿßŸÑÿÆŸÑŸÅŸäÿ© ŸÖŸÜ ŸÖŸÑŸÅ ÿßŸÑÿµŸàÿ±ÿ© ÿßŸÑÿ∞Ÿä ÿ£ÿ∂ŸÅÿ™Ÿá */
      background-image: url("IMG_20250823_082124_542.jpg");
      background-repeat: no-repeat;
      background-position: center center;
      background-attachment: fixed;
      background-size: cover;
    }

    /* Overlay ŸÑÿ∂ŸÖÿßŸÜ ÿ™ÿ®ÿßŸäŸÜ ÿßŸÑŸÜÿµ */
    body::before{
      content: "";
      position: fixed;
      inset: 0;
      background: linear-gradient(180deg, rgba(0,0,0,.45), rgba(0,0,0,.65));
      z-index: 0;
      pointer-events: none;
    }

    header, main, footer, .wrap { position: relative; z-index: 2; }
    :focus{ outline: 3px solid rgba(0,207,255,.18); outline-offset: 3px; }

    /* Header */
    .header{
      position: sticky;
      top:0;
      z-index: 120;
      background: rgba(7,18,28,.72);
      border-bottom: 1px solid rgba(255,255,255,.04);
      backdrop-filter: saturate(140%) blur(6px);
    }
    .nav{
      max-width:1200px; margin:auto; padding:12px 18px;
      display:flex; align-items:center; justify-content:space-between; gap:12px;
    }
    .brand{
      display:flex; align-items:center; gap:10px; color:var(--neon); font-weight:800; letter-spacing:.5px;
      text-shadow:0 0 12px rgba(0,207,255,.12);
    }
    .brand .dot{width:12px;height:12px;border-radius:50%;background:var(--neon);box-shadow:0 0 18px var(--neon)}
    .menu-btn{ width:46px;height:46px;border-radius:12px;display:grid;place-items:center;background:transparent;color:var(--text);border:1px solid rgba(255,255,255,.06);cursor:pointer; }
    .header-actions{display:flex;align-items:center;gap:8px}
    .btn{ border:0; cursor:pointer; font-weight:800; border-radius:12px; padding:10px 14px; background:var(--neon); color:#01222e; box-shadow: var(--shadow); transition:.16s transform, .24s box-shadow; }
    .btn.secondary{ background:#0e2232; color:var(--text); border:1px solid rgba(255,255,255,.06); }
    .btn:active{ transform:translateY(1px); }

    .wrap{ max-width:1200px; margin:20px auto; padding:0 18px 120px; }

    /* Home big game cards */
    .home-screen h1{ margin:6px 0 4px; text-align:center; font-size:20px; color:var(--neon) }
    .home-screen p.lead{ text-align:center; color:var(--muted); margin:0 0 14px; }

    .games-grid{
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap:18px;
      margin-top:8px;
    }
    .game-card{
      background: linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,.01));
      border:1px solid rgba(255,255,255,.04);
      border-radius:16px; padding:28px 18px; cursor:pointer;
      display:flex; flex-direction:column; gap:10px; align-items:center; justify-content:center;
      min-height:150px; transition:transform .22s, box-shadow .22s;
      box-shadow: var(--shadow);
    }
    .game-card:hover{ transform:translateY(-8px); box-shadow: var(--glow); }
    .game-logo{ width:54px;height:54px;border-radius:12px; display:grid;place-items:center; font-weight:900; color:var(--neon); background:linear-gradient(135deg,#ffffff10,#00cfff20) }
    .game-title{ font-weight:900; font-size:18px; color:var(--text) }
    .game-sub{ font-size:13px; color:var(--muted) }

    /* Detail screen */
    .detail-screen{ display:none }
    .detail-card{
      background: rgba(6,21,26,.85);
      border-radius:16px; padding:18px; border:1px solid rgba(255,255,255,.04);
      box-shadow: var(--shadow);
    }
    .detail-header{ display:flex; justify-content:space-between; align-items:center; gap:12px; margin-bottom:12px; }
    .detail-title{ font-size:20px; font-weight:900; color:var(--neon) }
    .detail-sub{ font-size:13px; color:var(--muted) }

    .pkg-grid{ display:grid; grid-template-columns: repeat(4,1fr); gap:12px; margin-top:8px; }
    @media (max-width:1100px){ .pkg-grid{ grid-template-columns: repeat(3,1fr) } }
    @media (max-width:820px){ .pkg-grid{ grid-template-columns: repeat(2,1fr) } }
    @media (max-width:520px){ .pkg-grid{ grid-template-columns: 1fr } }

    .pkg{ padding:14px; border-radius:12px; background:#071926; border:1px solid rgba(255,255,255,.03); cursor:pointer; transition:transform .16s, box-shadow .16s; display:flex; flex-direction:column; gap:8px; }
    .pkg:hover{ transform:translateY(-6px); box-shadow: var(--glow); }
    .pkg h3{ margin:0; font-size:15px; color:#fff; }
    .pkg .amount{ font-weight:900; font-size:16px; color:#fff } /* ÿßŸÑÿ£ÿπÿØÿßÿØ ÿ®ÿßŸÑŸÑŸàŸÜ ÿßŸÑÿ£ÿ®Ÿäÿ∂ */
    .pkg .price{ font-weight:900; color:var(--neon); font-size:14px; }
    .pkg .meta{ font-size:12px; color:var(--muted); margin-top:6px }
    .pkg.selected{ outline:2px solid rgba(0,207,255,.45); background: linear-gradient(180deg, rgba(0,207,255,.03), rgba(255,255,255,.01)); }

    .form{ margin-top:12px; display:grid; gap:10px; }
    .input{ width:100%; padding:12px; border-radius:12px; background:#06151a; color:var(--text); border:1px solid rgba(255,255,255,.04); font-size:15px; outline:none; }
    .help{ color:var(--muted); font-size:13px; }
    .actions{ display:flex; gap:8px; align-items:center; margin-top:6px; flex-wrap:wrap; }

    /* Modal */
    .modal{ position:fixed; inset:0; display:none; place-items:center; z-index:400; background:rgba(0,0,0,.56) }
    .modal.show{ display:grid }
    .modal-card{ width:min(720px,95vw); background:var(--card); padding:16px; border-radius:14px; border:1px solid rgba(255,255,255,.04); box-shadow:var(--glow) }
    .modal-head{ display:flex; justify-content:space-between; align-items:center }
    .summary{ background:#071926; padding:12px; border-radius:10px; margin-top:12px; white-space:pre-wrap; color:var(--text) }

    /* FAB & Support */
    .fab{ position:fixed; bottom:18px; left:18px; z-index:380; width:56px; height:56px; border-radius:50%; display:grid; place-items:center; background:var(--neon); color:#01222e; font-size:22px; box-shadow:0 16px 40px rgba(0,207,255,.18); cursor:pointer; }
    .support{ position:fixed; bottom:86px; left:18px; width:320px; background:var(--card); border-radius:12px; padding:12px; box-shadow:var(--glow); display:none; z-index:379 }
    .support.show{ display:block }
    .contact-row{ display:flex; gap:8px; margin-top:10px }
    .contact{ flex:1; padding:10px; border-radius:10px; background:#06151a; border:1px solid rgba(255,255,255,.03); text-align:center; cursor:pointer; }

    /* Sidebar */
    #sidebar{ pointer-events:none; position:fixed; inset:0; z-index:370 }
    #sbBackdrop{ position:absolute; inset:0; background:rgba(0,0,0,.36); opacity:0; transition:opacity .25s }
    #sbPanel{ position:absolute; top:0; right:-320px; width:300px; height:100%; background:var(--card); padding:16px; box-shadow:-14px 0 40px rgba(0,0,0,.6); border-left:1px solid rgba(255,255,255,.03); transition:right .28s }

    /* Toast */
    .toast{ position:fixed; bottom:20px; right:20px; z-index:420; padding:12px 14px; border-radius:12px; min-width:220px; background:rgba(1,32,44,.92); color:var(--text); display:none; border:1px solid rgba(255,255,255,.04); box-shadow:var(--glow) }
    .toast.show{ display:block; animation: toastIn .18s ease }
    @keyframes toastIn{ from{opacity:.3; transform:translateY(8px)}to{opacity:1; transform:none} }

    footer{ opacity:.9; text-align:center; padding:24px 12px; color:var(--muted); font-size:13px; z-index:2 }

    @media (max-width:520px){
      .game-logo{ width:44px;height:44px }
      .game-card{ padding:18px; min-height:120px }
      .pkg-grid{ gap:10px }
      .btn{ padding:8px 10px; font-size:14px }
    }
  </style>
</head>
<body>

  <!-- Sidebar -->
  <aside id="sidebar" aria-hidden="true">
    <div id="sbBackdrop"></div>
    <nav id="sbPanel" role="dialog" aria-label="ÿßŸÑŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ¨ÿßŸÜÿ®Ÿäÿ©">
      <h3 style="color:var(--neon); margin:6px 0 12px;">ÿßŸÑŸÇÿßÿ¶ŸÖÿ©</h3>
      <a href="#" data-close-sidebar style="display:block;padding:10px;border-radius:8px;background:#06151a;margin-bottom:8px;color:var(--text);text-decoration:none">üè† ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©</a>
      <a href="#gameGrid" data-close-sidebar style="display:block;padding:10px;border-radius:8px;background:#06151a;margin-bottom:8px;color:var(--text);text-decoration:none">üéÆ ÿßŸÑÿ£ŸÑÿπÿßÿ®</a>
      <a href="#contactSection" data-close-sidebar style="display:block;padding:10px;border-radius:8px;background:#06151a;margin-bottom:8px;color:var(--text);text-decoration:none">üìû ÿ™ŸàÿßÿµŸÑ</a>
    </nav>
  </aside>

  <!-- Header -->
  <header class="header" role="banner">
    <div class="nav">
      <div style="display:flex;align-items:center;gap:10px">
        <button id="openMenu" class="menu-btn" aria-label="ŸÅÿ™ÿ≠ ÿßŸÑŸÇÿßÿ¶ŸÖÿ©">‚ò∞</button>
        <div class="brand" aria-hidden="false"><span class="dot" aria-hidden="true"></span> EBX GAME STORE</div>
      </div>
      <div class="header-actions" role="navigation" aria-label="ÿ£ÿ≤ÿ±ÿßÿ± ÿ≥ÿ±Ÿäÿπÿ©">
        <button id="toggleAudio" class="btn secondary" aria-pressed="false" title="ÿ™ÿ¥ÿ∫ŸäŸÑ/ÿ•ŸäŸÇÿßŸÅ ÿßŸÑÿµŸàÿ™">üîä ÿ™ÿ¥ÿ∫ŸäŸÑ</button>
        <a href="#order" class="btn" style="text-decoration:none; color:inherit;">ÿßÿ∑ŸÑÿ® ÿßŸÑÿ¢ŸÜ</a>
      </div>
    </div>
  </header>

  <main class="wrap" role="main">
    <!-- Home Screen -->
    <section id="homeScreen" class="home-screen" aria-label="ÿßŸÑÿ¥ÿßÿ¥ÿ© ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©">
      <h1>ÿßÿÆÿ™ÿ± ŸÑÿπÿ®ÿ™ŸÉ</h1>
      <p class="lead small">ÿßÿ∂ÿ∫ÿ∑ ÿπŸÑŸâ ÿ£Ÿä ÿ®ÿ∑ÿßŸÇÿ© ŸÑÿπÿ±ÿ∂ ÿßŸÑÿ®ÿßŸÇÿßÿ™ ŸàÿßŸÑÿ£ŸäÿØŸä Ÿàÿ™ÿ£ŸÉŸäÿØ ÿßŸÑÿ∑ŸÑÿ®</p>
      <div id="gameGrid" class="games-grid" aria-live="polite" aria-label="ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ£ŸÑÿπÿßÿ®"></div>
    </section>

    <!-- Detail Screen -->
    <section id="detailScreen" class="detail-screen" aria-hidden="true" style="margin-top:18px;">
      <div class="detail-card">
        <div class="detail-header">
          <div>
            <div id="gameName" class="detail-title">ÿßÿ≥ŸÖ ÿßŸÑŸÑÿπÿ®ÿ©</div>
            <div id="gameNote" class="detail-sub small">ÿßÿÆÿ™Ÿéÿ± ÿßŸÑÿ®ÿßŸÇÿ© ÿ´ŸÖ ÿ£ÿØÿÆŸÑ ÿßŸÑŸÄ ID ŸÑŸÑÿ™ÿ£ŸÉŸäÿØ</div>
          </div>
          <div style="display:flex;gap:8px;align-items:center">
            <button id="backBtn" class="btn secondary" title="ÿßŸÑÿπŸàÿØÿ©">‚óÄ ÿ±ÿ¨Ÿàÿπ</button>
            <button id="manageBtn" class="btn secondary" title="ÿ•ÿ∂ÿßŸÅÿ©/ÿ™ÿπÿØŸäŸÑ ÿßŸÑÿ®ÿßŸÇÿßÿ™">üì¶ ÿ•ÿ∂ÿßŸÅÿ©/ÿ™ÿπÿØŸäŸÑ ÿßŸÑÿ®ÿßŸÇÿßÿ™</button>
            <button id="resetPrices" class="btn secondary" title="ÿ•ÿπÿßÿØÿ© ÿßŸÑÿ∂ÿ®ÿ∑">‚Ü∫ ÿ•ÿπÿßÿØÿ© ÿßŸÑÿ∂ÿ®ÿ∑</button>
          </div>
        </div>

        <div id="pkgGrid" class="pkg-grid" role="list" aria-live="polite"></div>

        <div class="form">
          <input id="playerId" class="input" inputmode="numeric" placeholder="ÿ£ÿØÿÆŸÑ ÿßŸÑŸÄ ID (ŸÖÿ´ÿßŸÑ: 1234567890)" aria-label="ŸÖÿπÿ±ŸÅ ÿßŸÑŸÑÿßÿπÿ®">
          <input id="server" class="input" placeholder="ÿßŸÑÿ≥Ÿäÿ±ŸÅÿ± / ÿßŸÑŸÖŸÜÿ∑ŸÇÿ© (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä)" aria-label="ÿßŸÑÿ≥Ÿäÿ±ŸÅÿ±">
          <input id="whats" class="input" inputmode="tel" placeholder="ÿ±ŸÇŸÖ Ÿàÿßÿ™ÿ≥ÿßÿ® ŸÑŸÑŸÖÿ™ÿßÿ®ÿπÿ© (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä)" aria-label="Ÿàÿßÿ™ÿ≥ÿßÿ®">
          <div class="actions">
            <button id="checkBtn" class="btn secondary">üîé ÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿßŸÑŸÄ ID</button>
            <button id="confirmBtn" class="btn">‚úÖ ÿ™ÿ£ŸÉŸäÿØ ÿßŸÑÿ∑ŸÑÿ®</button>
            <div style="flex:1"></div>
            <div id="status" class="small" aria-live="polite"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- Contact -->
    <section id="contactSection" style="margin-top:18px;">
      <div class="detail-card" id="contactCard">
        <h3 style="margin:0 0 8px; color:var(--neon)">ÿßŸÑÿ™ŸàÿßÿµŸÑ ÿßŸÑŸÖÿ®ÿßÿ¥ÿ±</h3>
        <div class="contact-row">
          <div class="contact" data-wa="+201004167961" role="button" tabindex="0">Ÿàÿßÿ™ÿ≥ÿßÿ® 1: 01004167961</div>
          <div class="contact" data-wa="+201029909720" role="button" tabindex="0">Ÿàÿßÿ™ÿ≥ÿßÿ® 2: 01029909720</div>
        </div>
        <p class="small" style="margin-top:10px;color:var(--muted)">ÿßÿ∂ÿ∫ÿ∑ ŸÑŸÅÿ™ÿ≠ ÿßŸÑŸÖÿ≠ÿßÿØÿ´ÿ© ŸÅŸä Ÿàÿßÿ™ÿ≥ÿßÿ® ŸÖÿ®ÿßÿ¥ÿ±ÿ©.</p>
      </div>
    </section>
  </main>

  <!-- Floating support -->
  <button id="fab" class="fab" aria-label="ÿØÿπŸÖ ÿ≥ÿ±Ÿäÿπ">üí¨</button>
  <div id="supportBox" class="support" role="dialog" aria-label="ÿØÿπŸÖ ÿ≥ÿ±Ÿäÿπ">
    <strong style="color:var(--neon)">üí¨ ÿØÿπŸÖ ÿ≥ÿ±Ÿäÿπ</strong>
    <div class="contact-row" style="margin-top:8px;">
      <div class="contact" data-wa="+201004167961">Ÿàÿßÿ™ÿ≥ÿßÿ® 1</div>
      <div class="contact" data-wa="+201029909720">Ÿàÿßÿ™ÿ≥ÿßÿ® 2</div>
    </div>
    <div class="contact-row" style="margin-top:8px;">
      <a class="contact" href="mailto:support@ebx.store" style="text-decoration:none;color:inherit">ÿ•ŸäŸÖŸäŸÑ ÿßŸÑÿØÿπŸÖ</a>
      <a class="contact" href="#detailScreen" style="text-decoration:none;color:inherit">ÿ∑ŸÑÿ® ÿ¨ÿØŸäÿØ</a>
    </div>
  </div>

  <!-- Confirm modal -->
  <div id="confirmModal" class="modal" role="dialog" aria-modal="true" aria-label="ÿ™ÿ£ŸÉŸäÿØ ÿßŸÑÿ∑ŸÑÿ®">
    <div class="modal-card">
      <div class="modal-head">
        <strong style="color:var(--neon)">ÿ™ÿ£ŸÉŸäÿØ ÿßŸÑÿ∑ŸÑÿ®</strong>
        <button id="closeModal" class="btn secondary">ÿ•ÿ∫ŸÑÿßŸÇ</button>
      </div>
      <div id="orderSummary" class="summary">ŸÖŸÑÿÆÿµ ÿßŸÑÿ∑ŸÑÿ® ÿ≥Ÿäÿ∏Ÿáÿ± ŸáŸÜÿß</div>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:12px;">
        <button id="sendWa1" class="btn">üì≤ ÿ•ÿ±ÿ≥ÿßŸÑ ŸÑŸàÿßÿ™ÿ≥ÿßÿ® 1</button>
        <button id="sendWa2" class="btn secondary">üì≤ ÿ•ÿ±ÿ≥ÿßŸÑ ŸÑŸàÿßÿ™ÿ≥ÿßÿ® 2</button>
      </div>
    </div>
  </div>

  <!-- Toast -->
  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <!-- Audio files -->
  <!-- ŸÖŸÑŸÅ ŸÖŸàÿ≥ŸäŸÇŸâ ÿßŸÑÿ™ÿ¥ÿ∫ŸäŸÑ ÿßŸÑÿÆŸÑŸÅŸä (Ÿäÿ¨ÿ® ÿ£ŸÜ ŸäŸÉŸàŸÜ ŸÖŸàÿ¨ŸàÿØÿßŸã ÿ•ÿ∞ÿß ÿ£ÿ±ÿØÿ™ ÿ™ÿ¥ÿ∫ŸäŸÑŸá ŸäÿØŸàŸäÿßŸã) -->
  <audio id="bgMusic" preload="none" loop>
    <source src="PS5 Startup.mp3" type="audio/mpeg" />
  </audio>

  <!-- ŸÜÿ∫ŸÖÿ© ÿßŸÑŸÜÿ¨ÿßÿ≠ (ÿ™ÿ¥ÿ∫ŸäŸÑ ÿπŸÜÿØ ÿ™ÿ£ŸÉŸäÿØ ÿßŸÑÿ∑ŸÑÿ®) -->
  <audio id="successSound" preload="auto">
    <source src="notification.mp3" type="audio/mpeg" />
  </audio>

  <!-- JavaScript ŸÉÿßŸÖŸÑ ŸàŸÖŸÇŸÅŸÑ -->
  <script>
    "use strict";

    /* DOM helpers */
    const qs = (s) => document.querySelector(s);
    const qsa = (s) => Array.from(document.querySelectorAll(s));

    /* Elements */
    const gameGridEl = qs('#gameGrid');
    const homeScreenEl = qs('#homeScreen');
    const detailScreenEl = qs('#detailScreen');
    const gameNameEl = qs('#gameName');
    const gameNoteEl = qs('#gameNote');
    const pkgGridEl = qs('#pkgGrid');
    const playerIdInput = qs('#playerId');
    const serverInput = qs('#server');
    const whatsInput = qs('#whats');
    const statusEl = qs('#status');
    const checkBtn = qs('#checkBtn');
    const confirmBtn = qs('#confirmBtn');
    const manageBtn = qs('#manageBtn');
    const resetBtn = qs('#resetPrices');
    const backBtn = qs('#backBtn');
    const openMenuBtn = qs('#openMenu');
    const sbBackdrop = qs('#sbBackdrop');
    const sbPanel = qs('#sbPanel');
    const sidebarContainer = qs('#sidebar');
    const fabBtn = qs('#fab');
    const supportBox = qs('#supportBox');
    const toggleAudioBtn = qs('#toggleAudio');
    const audioEl = qs('#bgMusic');
    const successSoundEl = qs('#successSound');
    const toastEl = qs('#toast');
    const confirmModal = qs('#confirmModal');
    const orderSummaryEl = qs('#orderSummary');
    const sendWa1Btn = qs('#sendWa1');
    const sendWa2Btn = qs('#sendWa2');
    const closeModalBtn = qs('#closeModal');

    /* WhatsApp numbers */
    const WA_NUMBER_1 = '+201004167961';
    const WA_NUMBER_2 = '+201029909720';

    /* Default prices (ŸÖÿ≠ÿØŸëÿ´ÿ© ÿ≠ÿ≥ÿ® ÿ∑ŸÑÿ®ŸÉ) */
    const DEFAULT_PRICES = {
      "PUBG": [
        { label:"60 UC", amount:60, price:47 },
        { label:"334 UC", amount:334, price:220 },
        { label:"678 UC", amount:678, price:650 },
        { label:"1845 UC", amount:1845, price:1250 },
        { label:"3940 UC", amount:3940, price:2820 },
        { label:"8280 UC", amount:8280, price:4800 }
      ],
      "Free Fire": [
        { label:"100 Diamonds", amount:100, price:52.92 },
        { label:"210 Diamonds", amount:210, price:105.84 },
        { label:"530 Diamonds", amount:530, price:264.60 },
        { label:"1080 Diamonds", amount:1080, price:529.20 },
        { label:"2200 Diamonds", amount:2200, price:1058.40 }
      ],
      "COD": [
        { label:"30 CP", amount:30, price:20 },
        { label:"80 CP", amount:80, price:50 },
        { label:"420 CP", amount:420, price:250 },
        { label:"880 CP", amount:880, price:500 },
        { label:"2400 CP", amount:2400, price:1250 },
        { label:"5000 CP", amount:5000, price:2500 }
      ],
      "Arena Breakout": [
        { label:"100 Bonds", amount:100, price:49.19 },
        { label:"500 Bonds", amount:500, price:247.95 },
        { label:"1000 Bonds", amount:1000, price:496.40 },
        { label:"2500 Bonds", amount:2500, price:1241.74 },
        { label:"5000 Bonds", amount:5000, price:2483.98 },
        { label:"10000 Bonds", amount:10000, price:4968.45 }
      ],
      "Ludo Gold": [
        { label:"68,500 Gold", amount:68500, price:113.47 },
        { label:"223,700 Gold", amount:223700, price:284.94 },
        { label:"1,463,320 Gold", amount:1463320, price:569.75 },
        { label:"3,666,470 Gold", amount:3666470, price:1424.97 },
        { label:"9,973,990 Gold", amount:9973990, price:2849.95 }
      ],
      "Ludo Diamonds": [
        { label:"83 Diamonds", amount:83, price:113.47 },
        { label:"2,320 Diamonds", amount:2320, price:284.94 },
        { label:"5,150 Diamonds", amount:5150, price:569.78 },
        { label:"13,580 Diamonds", amount:13580, price:1424.97 },
        { label:"27,640 Diamonds", amount:27640, price:2849.95 }
      ],
      "MLBB": [
        { label:"86 Diamonds", amount:86, price:65 },
        { label:"172 Diamonds", amount:172, price:120 },
        { label:"257 Diamonds", amount:257, price:175 }
      ],
      "Fortnite": [
        { label:"1000 V-Bucks", amount:1000, price:350 },
        { label:"2800 V-Bucks", amount:2800, price:900 },
        { label:"5000 V-Bucks", amount:5000, price:1500 }
      ]
    };

    /* ID lengths */
    const ID_LENGTHS = {
      "PUBG": 10,
      "Free Fire": 10,
      "COD": 8,
      "Arena Breakout": 17,
      "Ludo Gold": 6,
      "Ludo Diamonds": 6,
      "MLBB": 9,
      "Fortnite": 12
    };

    /* Local storage helpers */
    const STORE_KEY = 'EBX_STORE_PRICES_V3';
    function loadPricesFromStorage(){
      const raw = localStorage.getItem(STORE_KEY);
      if(!raw) return JSON.parse(JSON.stringify(DEFAULT_PRICES));
      try { return JSON.parse(raw); } catch(e) { return JSON.parse(JSON.stringify(DEFAULT_PRICES)); }
    }
    function savePricesToStorage(obj){
      localStorage.setItem(STORE_KEY, JSON.stringify(obj));
      showToast('ÿ™ŸÖ ÿ≠ŸÅÿ∏ ÿßŸÑÿ£ÿ≥ÿπÿßÿ± ŸÖÿ≠ŸÑŸäŸãÿß ‚úÖ');
    }
    function resetPricesToDefault(){
      if(!confirm('ŸáŸÑ ÿ™ÿ±ŸäÿØ ÿßÿ≥ÿ™ÿ±ÿ¨ÿßÿπ ÿßŸÑÿ£ÿ≥ÿπÿßÿ± ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ©ÿü')) return;
      localStorage.removeItem(STORE_KEY);
      prices = loadPricesFromStorage();
      renderHome();
      showHome();
      showToast('ÿ™ŸÖÿ™ ÿ•ÿπÿßÿØÿ© ÿßŸÑÿ£ÿ≥ÿπÿßÿ± ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ© ‚Ü∫');
    }

    /* State */
    let prices = loadPricesFromStorage();
    const GAME_KEYS = Object.keys(prices);
    let currentGame = null;
    let selectedPackage = null;
    let audioOn = false;

    /* Toast */
    function showToast(message, ms=2200){
      if(!toastEl) return;
      toastEl.textContent = message;
      toastEl.classList.add('show');
      setTimeout(()=> toastEl.classList.remove('show'), ms);
    }

    /* Format price */
    function formatEGP(v){
      return (typeof v === 'number') ? `${Number(v).toLocaleString('ar-EG')} EGP` : `${v} EGP`;
    }

    /* Render home game cards */
    function renderHome(){
      gameGridEl.innerHTML = '';
      GAME_KEYS.forEach((key) => {
        const card = document.createElement('div');
        card.className = 'game-card';
        card.tabIndex = 0;

        const logo = document.createElement('div'); logo.className = 'game-logo'; logo.textContent = key.split(' ').map(s=>s[0]).slice(0,2).join('').toUpperCase();
        const title = document.createElement('div'); title.className = 'game-title'; title.textContent = key;
        const sub = document.createElement('div'); sub.className = 'game-sub'; sub.textContent = 'ÿßÿ∂ÿ∫ÿ∑ ŸÑÿπÿ±ÿ∂ ÿßŸÑÿ®ÿßŸÇÿßÿ™';

        card.appendChild(logo); card.appendChild(title); card.appendChild(sub);

        card.addEventListener('click', ()=> openGame(key));
        card.addEventListener('keydown', (e)=> { if(e.key === 'Enter' || e.key === ' ') openGame(key); });

        gameGridEl.appendChild(card);
      });
    }

    /* Open game details */
    function openGame(key){
      currentGame = key;
      selectedPackage = null;

      homeScreenEl.style.display = 'none';
      detailScreenEl.style.display = 'block';
      detailScreenEl.setAttribute('aria-hidden','false');

      gameNameEl.textContent = key;
      const len = ID_LENGTHS[key] || 6;
      playerIdInput.value = '';
      playerIdInput.maxLength = len;
      playerIdInput.placeholder = `ÿ£ÿØÿÆŸÑ ID ${key} ‚Äî ${len} ÿ£ÿ±ŸÇÿßŸÖ`;
      gameNoteEl.textContent = `ŸÖÿ∑ŸÑŸàÿ® ${len} ÿ±ŸÇŸÖŸãÿß ŸÑŸÑÿπÿ®ÿ© ${key}.`;

      renderPackages();
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    /* Show home */
    function showHome(){
      detailScreenEl.style.display = 'none';
      detailScreenEl.setAttribute('aria-hidden','true');
      homeScreenEl.style.display = '';
      currentGame = null;
      selectedPackage = null;
      statusEl.textContent = '';
    }

    /* Render packages list */
    function renderPackages(){
      pkgGridEl.innerHTML = '';
      const list = prices[currentGame] || [];
      if(list.length === 0){
        const empty = document.createElement('div');
        empty.className = 'small';
        empty.textContent = 'ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ®ÿßŸÇÿßÿ™ ÿ®ÿπÿØ ‚Äî ÿßÿ∂ÿ∫ÿ∑ "ÿ•ÿ∂ÿßŸÅÿ©/ÿ™ÿπÿØŸäŸÑ ÿßŸÑÿ®ÿßŸÇÿßÿ™" ŸÑÿ•ÿ∂ÿßŸÅÿ©.';
        pkgGridEl.appendChild(empty);
        return;
      }
      list.forEach((pkg, idx) => {
        const btn = document.createElement('button');
        btn.className = 'pkg';
        btn.type = 'button';
        btn.setAttribute('role','button');

        const h3 = document.createElement('h3'); h3.textContent = pkg.label;
        const amt = document.createElement('div'); amt.className = 'amount'; amt.textContent = pkg.amount ? (typeof pkg.amount === 'number' ? pkg.amount.toLocaleString('ar-EG') : pkg.amount) : '';
        const pr = document.createElement('div'); pr.className = 'price'; pr.textContent = (typeof pkg.price === 'number') ? formatEGP(pkg.price) : String(pkg.price);
        const meta = document.createElement('div'); meta.className = 'meta'; meta.textContent = 'ÿ≥ÿ±Ÿäÿπ ‚Äî ÿ™ŸàÿµŸäŸÑ ŸÅŸàÿ±Ÿä';

        btn.appendChild(h3); btn.appendChild(amt); btn.appendChild(pr); btn.appendChild(meta);

        btn.addEventListener('click', () => {
          qsa('.pkg').forEach(x=>x.classList.remove('selected'));
          btn.classList.add('selected');
          selectedPackage = pkg;
        });

        if(idx === 0){ btn.classList.add('selected'); selectedPackage = pkg; }

        pkgGridEl.appendChild(btn);
      });
    }

    /* Validate ID */
    function validateId(){
      if(!currentGame) return {ok:false, msg:'ÿßÿÆÿ™ÿ± ŸÑÿπÿ®ÿ© ÿ£ŸàŸÑŸãÿß.'};
      const len = ID_LENGTHS[currentGame] || 6;
      const val = (playerIdInput.value || '').trim();
      if(!val) return {ok:false, msg:'ÿßŸÑÿ±ÿ¨ÿßÿ° ÿ•ÿØÿÆÿßŸÑ ÿßŸÑŸÄ ID.'};
      const numeric = /^[0-9]+$/.test(val);
      if(!numeric) return {ok:false, msg:'ÿßŸÑŸÄ ID Ÿäÿ¨ÿ® ÿ£ŸÜ ŸäŸÉŸàŸÜ ÿ£ÿ±ŸÇÿßŸÖ ŸÅŸÇÿ∑.'};
      if(val.length !== len) return {ok:false, msg:`ÿßŸÑŸÄ ID ŸÑŸÑÿπÿ®ÿ© ${currentGame} Ÿäÿ¨ÿ® ÿ£ŸÜ ŸäŸÉŸàŸÜ ${len} ÿ±ŸÇŸÖŸãÿß.`};
      return {ok:true, msg:'‚úîÔ∏è ÿßŸÑŸÄ ID Ÿäÿ®ÿØŸà ÿµÿ≠Ÿäÿ≠Ÿãÿß.'};
    }

    /* Check button */
    checkBtn.addEventListener('click', ()=> {
      if(!currentGame){ showToast('ÿßÿÆÿ™ÿ± ŸÑÿπÿ®ÿ© ÿ£ŸàŸÑÿßŸã'); return; }
      statusEl.textContent = '‚è≥ ÿ¨ÿßÿ±Ÿê ÿßŸÑÿ™ÿ≠ŸÇŸÇ...';
      const res = validateId();
      setTimeout(()=> { statusEl.textContent = res.msg; showToast(res.msg,1200); }, 300);
    });

    /* Play success sound safely */
    function playSuccessSound(){
      try{
        if(successSoundEl){
          successSoundEl.currentTime = 0;
          successSoundEl.play().catch(()=>{ /* ŸÖŸÖŸÉŸÜ Ÿäÿ™ŸÖ ÿ≠ÿ∏ÿ± ÿßŸÑÿ™ÿ¥ÿ∫ŸäŸÑ ÿ•ÿ∞ÿß ŸÑŸÖ Ÿäÿ≠ÿØÿ´ ÿ™ŸÅÿßÿπŸÑ */ });
        }
      }catch(e){ /* ÿ™ÿ¨ÿßŸáŸÑ ÿ£ÿÆÿ∑ÿßÿ° ÿßŸÑÿ™ÿ¥ÿ∫ŸäŸÑ */ }
    }

    /* Confirm order */
    confirmBtn.addEventListener('click', ()=> {
      if(!selectedPackage){ statusEl.textContent = 'Ÿäÿ±ÿ¨Ÿâ ÿßÿÆÿ™Ÿäÿßÿ± ÿ®ÿßŸÇÿ© ÿ£ŸàŸÑŸãÿß.'; showToast('Ÿäÿ±ÿ¨Ÿâ ÿßÿÆÿ™Ÿäÿßÿ± ÿ®ÿßŸÇÿ© ÿ£ŸàŸÑŸãÿß.'); return; }
      const check = validateId();
      if(!check.ok){ statusEl.textContent = check.msg; showToast(check.msg); return; }

      // ÿ™ÿ¥ÿ∫ŸäŸÑ ŸÜÿ∫ŸÖÿ© ÿßŸÑŸÜÿ¨ÿßÿ≠ ÿπŸÜÿØ ÿ™ÿ£ŸÉŸäÿØ ÿßŸÑÿ∑ŸÑÿ®
      playSuccessSound();

      const summaryLines = [
        `ÿ∑ŸÑÿ® ÿ¨ÿØŸäÿØ ŸÖŸÜ EBX GAME STORE`,
        `‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî`,
        `ÿßŸÑŸÑÿπÿ®ÿ©: ${currentGame}`,
        `ÿßŸÑÿ®ÿßŸÇÿ©: ${selectedPackage.label}`,
        `ÿßŸÑÿ≥ÿπÿ±: ${(typeof selectedPackage.price === 'number') ? formatEGP(selectedPackage.price) : String(selectedPackage.price)}`,
        `ID: ${playerIdInput.value.trim()}`,
        `ÿßŸÑÿ≥Ÿäÿ±ŸÅÿ±/ÿßŸÑŸÖŸÜÿ∑ŸÇÿ©: ${serverInput.value || '‚Äî'}`,
        `Ÿàÿßÿ™ÿ≥ÿßÿ® ŸÑŸÑŸÖÿ™ÿßÿ®ÿπÿ©: ${whatsInput.value || '‚Äî'}`,
        `ÿ™ÿßÿ±ŸäÿÆ: ${new Date().toLocaleString('ar-EG')}`
      ];
      const summary = summaryLines.join('\n');

      orderSummaryEl.textContent = summary;
      confirmModal.classList.add('show');

      sendWa1Btn.onclick = ()=> openWhats(WA_NUMBER_1, summary);
      sendWa2Btn.onclick = ()=> openWhats(WA_NUMBER_2, summary);
    });

    closeModalBtn.addEventListener('click', ()=> confirmModal.classList.remove('show'));

    function openWhats(number, summary){
      const url = `https://wa.me/${number.replace(/\+/g,'')}?text=${encodeURIComponent(summary)}`;
      window.open(url, '_blank');
    }

    /* Manage packages */
    manageBtn.addEventListener('click', ()=>{
      if(!currentGame){ showToast('ÿßÿÆÿ™ÿ± ŸÑÿπÿ®ÿ© ŸÑÿ™ÿπÿØŸäŸÑ ÿ®ÿßŸÇÿßÿ™Ÿáÿß'); return; }
      const existing = prices[currentGame] || [];
      const lines = existing.map(p => `${p.label} | ${p.amount} | ${p.price}`).join('\n');
      const promptText = `ÿ™ÿ≠ÿ±Ÿäÿ± ÿ®ÿßŸÇÿßÿ™ ${currentGame}:\nŸÉŸÑ ÿ≥ÿ∑ÿ± = label | amount | price\nŸÖÿ´ÿßŸÑ:\n60 UC | 60 | 47\n\nÿßŸÑÿ®ÿßŸÇÿßÿ™ ÿßŸÑÿ≠ÿßŸÑŸäÿ©:\n${lines || '(ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ®ÿßŸÇÿßÿ™)'}`;
      const input = prompt(promptText, lines);
      if(input === null) return;
      const next = [];
      input.split(/\r?\n/).map(s=>s.trim()).filter(Boolean).forEach(row=>{
        const parts = row.split('|').map(x=>x.trim());
        if(parts.length < 2) return;
        const label = parts[0] || '';
        const amount = Number((parts[1]||'0').toString().replace(/,/g,'')) || 0;
        const price = Number((parts[2]||parts[1]||'0').toString().replace(/,/g,'')) || 0;
        if(!label) return;
        next.push({ label, amount, price });
      });
      prices[currentGame] = next;
      savePricesToStorage(prices);
      renderPackages();
    });

    resetBtn.addEventListener('click', ()=> resetPricesToDefault());

    /* Sidebar open/close */
    function openSidebar(){ sidebarContainer.style.pointerEvents = 'auto'; sbBackdrop.style.opacity = '1'; sbPanel.style.right = '0'; sidebarContainer.classList.add('open'); }
    function closeSidebar(){ sidebarContainer.style.pointerEvents = 'none'; sbBackdrop.style.opacity = '0'; sbPanel.style.right = '-320px'; sidebarContainer.classList.remove('open'); }
    openMenuBtn.addEventListener('click', openSidebar);
    sbBackdrop.addEventListener('click', closeSidebar);
    qsa('#sbPanel [data-close-sidebar]').forEach(a => a.addEventListener('click', closeSidebar));
    document.addEventListener('keydown', (e)=>{ if(e.key === 'Escape') closeSidebar(); });

    /* Back button */
    backBtn.addEventListener('click', ()=> showHome());

    /* FAB support */
    fabBtn.addEventListener('click', ()=> supportBox.classList.toggle('show'));
    qsa('#supportBox .contact[data-wa]').forEach(el => el.addEventListener('click', ()=> openWhats(el.dataset.wa, 'ŸÖÿ±ÿ≠ÿ®Ÿãÿßÿå ÿ£ÿ≠ÿ™ÿßÿ¨ ÿØÿπŸÖ EBX.')) );
    qsa('#contactCard .contact[data-wa]').forEach(el => el.addEventListener('click', ()=> openWhats(el.dataset.wa, 'ŸÖÿ±ÿ≠ÿ®Ÿãÿßÿå ÿ£ÿ±ŸäÿØ ÿßÿ≥ÿ™ÿπŸÑÿßŸÖŸãÿß ÿπŸÜ ÿßŸÑÿ¥ÿ≠ŸÜ.')) );

    /* Audio toggle */
    toggleAudioBtn.addEventListener('click', async ()=>{
      try{
        if(!audioOn){ await audioEl.play(); toggleAudioBtn.textContent = 'üîá ŸÉÿ™ŸÖ'; }
        else{ audioEl.pause(); toggleAudioBtn.textContent = 'üîä ÿ™ÿ¥ÿ∫ŸäŸÑ'; }
        audioOn = !audioOn;
      }catch(err){ showToast('ÿ™ÿπÿ∞Ÿëÿ± ÿ™ÿ¥ÿ∫ŸäŸÑ ÿßŸÑÿµŸàÿ™: ÿ™ŸÅÿßÿπŸÑ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ŸÖÿ∑ŸÑŸàÿ® ÿ£Ÿà ÿßŸÑŸÖŸÑŸÅ ÿ∫Ÿäÿ± ŸÖŸàÿ¨ŸàÿØ.'); }
    });

    /* Init */
    function init(){ renderHome(); showHome(); setTimeout(()=> { fabBtn.classList.add('visible'); }, 400); }
    init();
  </script>
</body>
</html>
